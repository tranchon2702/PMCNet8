@model PMCNet8.Models.SaleViewModel
@{
    ViewData["Title"] = "Bán hàng tích điểm";
}
<section class="content">
    <div class="container-fluid">
        <div class="card">
            <div class="card-body">
                <div class="row align-items-end">
                    <div class="col-md-2">
                        <div class="form-group">
                            <label for="startDate">Từ ngày</label>
                            <input type="date" id="startDate" class="form-control flatpickr" placeholder="dd/mm/yyyy">
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label for="endDate">Đến ngày</label>
                            <input type="date" id="endDate" class="form-control flatpickr" placeholder="dd/mm/yyyy">
                        </div>
                    </div>
                    <div class="col-md-2">
                        <button id="viewButton" class="btn btn-primary btn-block">Xem</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="saleDataContainer"></div>
</section>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>

        $(document).ready(function () {
            flatpickr(".flatpickr", {
                dateFormat: "d/m/Y",
                allowInput: true,
                locale: "vn"
            });
            $('#viewButton').click(function () {
                var startDate = $('#startDate').val();
                var endDate = $('#endDate').val();
                loadSaleData(startDate, endDate);
            });

            $(document).ready(function () {
                $('#logoutButton').click(function (e) {
                    e.preventDefault();
                    $.ajax({
                        url: '@Url.Action("Logout", "Account")',
                        type: 'POST',
                        success: function (result) {
                            if (result.success) {
                                window.location.href = result.redirectUrl;
                            } else {
                                console.log('Logout failed');
                            }
                        },
                        error: function (error) {
                            console.log('Logout error:', error);
                        }
                    });
                });
            });
            function loadSaleData(startDate, endDate) {
                $.ajax({
                    url: '@Url.Action("GetSaleData", "Sale")',
                    data: {
                        sponsorId : sponsorId,
                        startDate: startDate, 
                        endDate: endDate },
                    type: 'GET',
                    success: function (result) {
                        $('#saleDataContainer').html(result);
                    },
                    error: function (error) {
                        console.log('Error:', error);
                    }
                });
            }
        });
    </script>
}